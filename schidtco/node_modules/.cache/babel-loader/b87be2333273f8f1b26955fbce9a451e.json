{"ast":null,"code":"var _objectSpread = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread\");\n\nvar _require = require('multiformats'),\n    CID = _require.CID;\n\nvar Uploader = require('s3-streaming-upload').Uploader;\n\nvar streamUploadFile = function streamUploadFile(s3, params) {\n  return new Promise(function (resolve, reject) {\n    var request = new Uploader(_objectSpread({\n      service: s3,\n      objectParams: {\n        ACL: 'public-read'\n      }\n    }, params));\n    request.send(function (err, data) {\n      if (err) {\n        reject(err);\n      }\n\n      var ETag = data.ETag;\n      var hash = ETag.replace(/^\"|\"$/g, '');\n      var cidObj = CID.parse(hash);\n      var cidv0;\n      var cidv1 = cidObj.toV1().toString();\n\n      try {\n        cidv0 = cidObj.toV0().toString();\n      } catch (e) {\n        // fallback when cbor is used\n        cidv0 = cidv1;\n      }\n\n      resolve({\n        hash: cidv1,\n        hashV0: cidv0\n      });\n    });\n  });\n};\n\nmodule.exports = streamUploadFile;","map":null,"metadata":{},"sourceType":"script"}