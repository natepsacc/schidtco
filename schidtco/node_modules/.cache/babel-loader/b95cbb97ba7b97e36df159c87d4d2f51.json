{"ast":null,"code":"var _classCallCheck = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/schidtery/Desktop/schidtco/schidtco/schidtco/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _require = require('events'),\n    EventEmitter = _require.EventEmitter;\n\nvar aws = require('aws-sdk');\n\nvar Uploader = /*#__PURE__*/function (_EventEmitter) {\n  \"use strict\";\n\n  _inherits(Uploader, _EventEmitter);\n\n  // Constructor\n  function Uploader(_ref, cb) {\n    var _this;\n\n    var accessKey = _ref.accessKey,\n        secretKey = _ref.secretKey,\n        sessionToken = _ref.sessionToken,\n        region = _ref.region,\n        stream = _ref.stream,\n        objectName = _ref.objectName,\n        objectParams = _ref.objectParams,\n        bucket = _ref.bucket,\n        partSize = _ref.partSize,\n        service = _ref.service,\n        debug = _ref.debug;\n\n    _classCallCheck(this, Uploader);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Uploader).call(this));\n    _this.cb = cb;\n    aws.config.update({\n      accessKeyId: accessKey,\n      secretAccessKey: secretKey,\n      sessionToken: sessionToken,\n      region: region || undefined\n    });\n    var params = {\n      Bucket: bucket,\n      Key: objectName,\n      Body: stream\n    };\n\n    for (var k in objectParams || {}) {\n      if (!params[k]) {\n        params[k] = objectParams[k];\n      }\n    }\n\n    _this.objectName = objectName;\n    _this.objectParams = params;\n    _this.timeout = 300000;\n    _this.debug = debug || false;\n\n    if (!_this.objectParams.Bucket) {\n      throw new Error('Bucket must be given');\n    }\n\n    _this.upload = new aws.S3.ManagedUpload({\n      partSize: partSize || 10 * 1024 * 1024,\n      queueSize: 4,\n      service: service,\n      params: params\n    }); // Progress event\n\n    _this.upload.on('httpUploadProgress', function (progress) {\n      if (_this.debug) {\n        console.log(\"\".concat(progress.loaded, \" / \").concat(progress.total));\n      }\n    });\n\n    return _this;\n  } // Send stream\n\n\n  _createClass(Uploader, [{\n    key: \"send\",\n    value: function send(callback) {\n      this.upload.send(function (err, data) {\n        if (err) {\n          console.log(err, data);\n        }\n\n        callback(err, data);\n      });\n    }\n  }]);\n\n  return Uploader;\n}(EventEmitter);\n\nmodule.exports = {\n  Uploader: Uploader\n};","map":null,"metadata":{},"sourceType":"script"}